Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["CoMMfoc: Complex-Focus fields in Mathematica",
 FontSize->
  36]], "Title",ExpressionUUID->"4f97aa06-5237-417d-a3de-abc5fa8e4b58"],

Cell["\<\
\[Copyright] Rodrigo Guti\[EAcute]rrez-Cuevas & Emilio Pisanty (2020). \
Licensed under GPL and CC-BY-SA.\
\>", "Text",ExpressionUUID->"e4423e52-691d-4b3a-910a-227a5f4c9d8a"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellTags->
  "Introduction",ExpressionUUID->"c6192770-807e-4c6d-bd69-7a28378f3924"],

Cell[CellGroupData[{

Cell["Text.", "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"6ac175a7-f178-4dfe-9bdc-458722381b12"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "the", " ", "CoMMfoc", " ", 
    RowBox[{"package", ".", " ", "For"}], " ", "the", " ", "notebook", " ", 
    "that", " ", "generated", " ", "this", " ", "package", " ", "file", " ", 
    "and", " ", "additional", " ", "documentaion"}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", 
     RowBox[{"https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"github", ".", "com"}], "/", "CoMMfoc"}], "/", "CoMMfoc"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->
  True,ExpressionUUID->"82d38177-9df9-4b82-9d60-a29240b5c273"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package admin", \
"Section",ExpressionUUID->"63ce1fac-976b-4ffb-9096-45068b912d68"],

Cell[CellGroupData[{

Cell["Initialization", \
"Subsection",ExpressionUUID->"5aeda15b-76fe-4aed-a4a6-75764c3d3231"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<CoMMfoc`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d8194a12-20ba-4527-9da4-5c21f77858c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package admin", \
"Subsection",ExpressionUUID->"b342e1b8-f293-4421-bf51-03eecc098c29"],

Cell[CellGroupData[{

Cell["Version number", "Subsubsection",
 CellTags->
  "version-section",ExpressionUUID->"4a58faea-5e89-4a18-8638-f58dbf15ff2e"],

Cell["\<\
The command RBSFAversion prints the version of the RB-SFA package currently \
loaded and its timestamp\
\>", "Text",ExpressionUUID->"3cc4e9c7-4560-4484-b6a1-3feb4291ed7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$CoMMfocVersion", "::", "usage"}], "=", 
   "\"\<$CoMMfocVersion prints the current version of the RB-SFA package in \
use and its timestamp.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CoMMfocTimestamp", "::", "usage"}], "=", 
   "\"\<$CoMMfocTimestamp prints the timestamp of the current version of the \
RB-SFA package.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CoMMfocVersion", ":=", 
   RowBox[{"\"\<CoMMfoc v0.1, \>\"", "<>", "$CoMMfoctimestamp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"aa97ee0f-f35a-441d-9482-ce45b1a816f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Timestamp managing", \
"Subsubsection",ExpressionUUID->"bab1b316-b4f7-41a1-afe2-2f4c639c1d6d"],

Cell["\<\
The timestamp is updated every time the notebook is saved via an appropriate \
notebook option, which is set by the code below.\
\>", "Text",ExpressionUUID->"887427dc-d969-4eef-9ca3-6df9cab14874"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"NotebookEventActions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MenuCommand\>\"", ",", "\"\<Save\>\""}], "}"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NotebookWrite", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Cells", "[", 
              RowBox[{"CellTags", "\[Rule]", "\"\<version-timestamp\>\""}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Cell", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"BoxData", "[", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Begin[\\\"`Private`\\\"];\\n$CoMMfocTimestamp=\\\"\>\"",
                   "<>", 
                  RowBox[{"DateString", "[", "]"}], "<>", 
                  "\"\<\\\";\\nEnd[];\>\""}], "}"}], "]"}], "]"}], 
              "\[IndentingNewLine]", ",", "\"\<Input\>\"", ",", 
              RowBox[{"InitializationCell", "\[Rule]", "True"}], ",", 
              RowBox[{"CellTags", "\[Rule]", "\"\<version-timestamp\>\""}]}], 
             "\[IndentingNewLine]", "]"}], ",", "None", ",", 
            RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookSave", "[", "]"}]}], "\[IndentingNewLine]", 
         ")"}]}], ",", 
       RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",ExpressionUUID->"9fc2d5fa-1617-4717-8d93-fc3b81379664"],

Cell["To reset this behaviour to normal, evaluate the cell below", \
"Text",ExpressionUUID->"bc795509-3913-49b6-84f3-de50f36f2b1a"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"NotebookEventActions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<MenuCommand\>\"", ",", "\"\<Save\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"NotebookSave", "[", "]"}], ")"}]}], ",", 
      RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "}"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"45760a97-ec43-42f5-a401-6d3b7f33f832"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Timestamp", \
"Subsubsection",ExpressionUUID->"2ac2d3ad-8207-436c-afb8-bc0ae16d4c35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$CoMMfocTimestamp", "=", "\"\<Sun 27 Sep 2020 18:33:28\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellTags->
  "version-timestamp",ExpressionUUID->"2980eb04-fc88-4d24-9afd-595d0373dba4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directory", \
"Subsubsection",ExpressionUUID->"d265a8f6-abd3-4556-b1e7-2a394098c33f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$CoMMfocDirectory", "::", "usage"}], "=", 
   "\"\<$CoMMfocDirectory is the directory where the current RB-SFA package \
instance is located.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c87f6883-8e5e-4a34-a1b9-2f3cdfa24230"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"softLinkTestString", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"ReadList", "[", 
          RowBox[{
           RowBox[{"\"\<! ls -la \>\"", "<>", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"$InputFileName", ",", 
              RowBox[{"{", 
               RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], 
             "]"}]}], ",", "String"}], "]"}], "]"}], ",", "\"\< -> \>\""}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "softLinkTestString", "]"}], ">", "1"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Testing", " ", "in", " ", "case", " ", "$InputFileName", " ", "is", 
        " ", "a", " ", "soft", " ", "link", " ", "to", " ", "the", " ", 
        "actual", " ", 
        RowBox[{"directory", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"$CoMMfocDirectory", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"DirectoryName", "[", 
          RowBox[{
          "softLinkTestString", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], "]"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"$CoMMfocDirectory", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f4003c50-c4bf-43a7-96de-6f1292ddff7e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Git commit hash and message", \
"Subsubsection",ExpressionUUID->"b01571eb-22a0-4ae9-bcdf-68217bd8bd00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$CoMMfocCommit", "::", "usage"}], "=", 
   "\"\<$CoMMfocCommit returns the git commit log at the location of the \
RB-SFA package if there is one.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CoMMfocCommit", "::", "OS"}], "=", 
   "\"\<$CoMMfocCommit has only been tested on Linux.\>\""}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"fce25619-8923-4995-9cae-ebb712b0cd01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$CoMMfocCommit", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$OperatingSystem", "\[NotEqual]", "\"\<Unix\>\""}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"$CoMMfocCommit", "::", "OS"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"ReadList", "[", 
         RowBox[{
          RowBox[{
          "\"\<!cd \>\"", "<>", "$CoMMfocDirectory", "<>", 
           "\"\< && git log -1\>\""}], ",", "String"}], "]"}], ",", 
        RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"56b69d2c-3f13-4848-bcc7-6db05f85bf58"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package code", \
"Section",ExpressionUUID->"3844a50e-ebb3-4a6c-8d34-f82b94b045bd"],

Cell[CellGroupData[{

Cell["SolidHarmonicS", \
"Subsection",ExpressionUUID->"ce066b21-33f3-4900-bb2d-ab254654ae24"],

Cell[TextData[{
 "This function implements the solid harmonic ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", 
      RowBox[{"l", ",", "m"}]], "(", 
     StyleBox["r",
      FontWeight->"Bold"], ")"}], "=", 
    RowBox[{
     SuperscriptBox["r", "l"], 
     RowBox[{
      SubscriptBox["Y", 
       RowBox[{"l", ",", "m"}]], "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"ff1a7c97-fd16-4e84-a045-0d295246ab11"],
 ", which is a homogeneous polynomial of degree ",
 Cell[BoxData[
  FormBox["l", TraditionalForm]],ExpressionUUID->
  "1a7df1cc-f549-49c6-a885-447a0d80d3ac"],
 ", and lends itself much better to symbolic differentiation than explicit \
spherical harmonics.\n\nCode provided by J.M. at \
http://mathematica.stackexchange.com/a/124336/1000 under the WTFPL."
}], "Text",ExpressionUUID->"5ffc79c6-f6d8-4512-8151-b93a8d9cc9b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SolidHarmonicS", "::", "usage"}], "=", 
   "\"\<SolidHarmonicS[l,m,x,y,z] calculates the solid harmonic \
\!\(\*SubscriptBox[\(S\), \(lm\)]\)(x,y,z)=\!\(\*SuperscriptBox[\(r\), \(l\)]\
\)\!\(\*SubscriptBox[\(Y\), \(lm\)]\)(x,y,z).\n\nSolidHarmonicS[l,m,{x,y,z}] \
does the same.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolidHarmonicS", "[", 
    RowBox[{
    "\[Lambda]_Integer", ",", "\[Mu]_Integer", ",", "x_", ",", "y_", ",", 
     "z_"}], "]"}], "/;", 
   RowBox[{"\[Lambda]", "\[GreaterEqual]", 
    RowBox[{"Abs", "[", "\[Mu]", "]"}]}]}], ":=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "\[Lambda]"}], "+", "1"}], 
     RowBox[{"4", " ", "\[Pi]"}]], "]"}], " ", 
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{"Gamma", "[", 
      RowBox[{"\[Lambda]", "-", 
       RowBox[{"Abs", "[", "\[Mu]", "]"}], "+", "1"}], "]"}], 
     RowBox[{"Gamma", "[", 
      RowBox[{"\[Lambda]", "+", 
       RowBox[{"Abs", "[", "\[Mu]", "]"}], "+", "1"}], "]"}]], "]"}], " ", 
   SuperscriptBox["2", 
    RowBox[{"-", "\[Lambda]"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Mu]", "-", 
       RowBox[{"Abs", "[", "\[Mu]", "]"}]}], ")"}], "/", "2"}]], "\[Times]", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rationalize", "[", "\[Mu]", "]"}], "\[Equal]", "0"}], ",", "1",
      ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "+", 
        RowBox[{
         RowBox[{"Sign", "[", "\[Mu]", "]"}], "\[ImaginaryI]", " ", "y"}]}], 
       ")"}], 
      RowBox[{"Abs", "[", "\[Mu]", "]"}]]}], "]"}], "\[Times]", 
   "\[IndentingNewLine]", 
   RowBox[{"Sum", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"\[Mu]", "+", "k"}]], " ", 
      RowBox[{"Binomial", "[", 
       RowBox[{"\[Lambda]", ",", "k"}], "]"}], " ", 
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "\[Lambda]"}], "-", 
         RowBox[{"2", " ", "k"}]}], ",", "\[Lambda]"}], "]"}], " ", 
      RowBox[{"Pochhammer", "[", 
       RowBox[{
        RowBox[{"\[Lambda]", "-", 
         RowBox[{"Abs", "[", "\[Mu]", "]"}], "-", 
         RowBox[{"2", " ", "k"}], "+", "1"}], ",", 
        RowBox[{"Abs", "[", "\[Mu]", "]"}]}], "]"}], " ", "\[Times]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Pochhammer", "[", 
           RowBox[{
            RowBox[{"\[Lambda]", "-", 
             RowBox[{"Abs", "[", "\[Mu]", "]"}], "-", 
             RowBox[{"2", " ", "k"}], "+", "1"}], ",", 
            RowBox[{"Abs", "[", "\[Mu]", "]"}]}], "]"}], "\[Equal]", "0"}], 
         "]"}], ",", "1", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rationalize", "[", "k", "]"}], "\[Equal]", "0"}], ",", 
           "1", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], "k"]}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"\[Lambda]", "-", 
              RowBox[{"Abs", "[", "\[Mu]", "]"}], "-", 
              RowBox[{"2", " ", "k"}]}], "]"}], "\[Equal]", "0"}], ",", "1", 
           ",", 
           SuperscriptBox["z", 
            RowBox[{"\[Lambda]", "-", 
             RowBox[{"Abs", "[", "\[Mu]", "]"}], "-", 
             RowBox[{"2", " ", "k"}]}]]}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", 
       RowBox[{"Quotient", "[", 
        RowBox[{"\[Lambda]", ",", "2"}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolidHarmonicS", "[", 
    RowBox[{"\[Lambda]_Integer", ",", "\[Mu]_Integer", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "/;", 
   RowBox[{"\[Lambda]", "\[GreaterEqual]", 
    RowBox[{"Abs", "[", "\[Mu]", "]"}]}]}], ":=", 
  RowBox[{"SolidHarmonicS", "[", 
   RowBox[{"\[Lambda]", ",", "\[Mu]", ",", "x", ",", "y", ",", "z"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"53f36aab-68fb-4989-8c67-cfe0a0e9f7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["AnalyticalBesselJ", \
"Subsection",ExpressionUUID->"9b9e0ef1-5a30-4169-a872-3cfb1a95a411"],

Cell["\<\
Define the analytical Bessel functions that go with the solid harmonics, as \
well as their differentiation rules.\
\>", "Text",ExpressionUUID->"76a6b390-5a4e-4a6a-95ac-68d711efaa97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AnalyticalBesselJ", "::", "usage"}], "=", 
    "\"\<AnalyticalBesselJ[m,{x,y,z}] returns the analytical form of the \
spherical Bessel function, \!\(\*SubscriptBox[\(j\), \
\(m\)]\)(r)/\!\(\*SuperscriptBox[\(r\), \(m\)]\).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AnalyticalBesselJ", "[", 
   RowBox[{"m_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"y_", "?", "NumericQ"}], ",", 
      RowBox[{"z_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", 
  FractionBox[
   RowBox[{"SphericalBesselJ", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "m", "]"}], ",", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]}], "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}], 
    RowBox[{
     RowBox[{"Abs", "[", "m", "]"}], "/", "2"}]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnalyticalBesselJ", "[", 
    RowBox[{"m_", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x_", "?", "NumericQ"}], ",", 
        RowBox[{"y_", "?", "NumericQ"}], ",", 
        RowBox[{"z_", "?", "NumericQ"}]}], "}"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], "\[Equal]", "0"}], "||", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], "\[Equal]", "0."}]}], ")"}]}]}], "]"}], 
   ":=", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "m"}], "+", "1"}], ")"}], "!!"}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
    "AnalyticalBesselJ", "]"}], "[", 
   RowBox[{"m_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "x", " ", 
   RowBox[{"AnalyticalBesselJ", "[", 
    RowBox[{
     RowBox[{"m", "+", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "[", 
    "AnalyticalBesselJ", "]"}], "[", 
   RowBox[{"m_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "y", " ", 
   RowBox[{"AnalyticalBesselJ", "[", 
    RowBox[{
     RowBox[{"m", "+", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
     "AnalyticalBesselJ", "]"}], "[", 
    RowBox[{"m_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "z", " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{
      RowBox[{"m", "+", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"2595089e-5a75-43d8-87be-ae8274f74fca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Multipole\[CapitalLambda]", \
"Subsection",ExpressionUUID->"4f41a858-1216-4f69-a0a9-6de6b815f17c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Multipole\[CapitalLambda]", "::", "usage"}], "=", 
    "\"\<Multipole\[CapitalLambda][l,m,{x,y,z}] calculates the multipole \
function \!\(\*SubscriptBox[\(\[CapitalLambda]\), \(l, \
m\)]\)(x,y,z)=4\!\(\*SuperscriptBox[\(\[Pi]i\), \
\(l\)]\)\!\(\*SubscriptBox[\(j\), \(l\)]\)(r)\!\(\*SubscriptBox[\(Y\), \
\(lm\)]\)(\[Theta],\[Phi])=4\!\(\*SuperscriptBox[\(\[Pi]i\), \
\(l\)]\)\!\(\*SubscriptBox[\(aj\), \(l\)]\)(r)\!\(\*SubscriptBox[\(S\), \
\(lm\)]\)(x,y,z).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Multipole\[CapitalLambda]", "[", 
    RowBox[{"l_", ",", "m_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"4", "\[Pi]", " ", 
    SuperscriptBox["\[ImaginaryI]", "l"], 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"l", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
    RowBox[{"SolidHarmonicS", "[", 
     RowBox[{"l", ",", "m", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"97bacd18-5916-4ffd-9528-2285cc18b967"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polarization handling", \
"Subsection",ExpressionUUID->"6f604981-3a3d-458b-a5b5-59f5e1b8d14d"],

Cell[CellGroupData[{

Cell["Previous versions", \
"Subsubsection",ExpressionUUID->"ca4d666b-29f9-4733-b4e8-6066d4190d2c"],

Cell[TextData[{
 "This defines a function that acts on the multipoles and vectorizes them \
according to the electric and magnetic type dipolar distributions. Note that \
the circular polarization operators we were initially using required a \
combination of the two. They\[CloseCurlyQuote]re written such that if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "=", "r"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fecf1dcf-d667-4599-8363-287188f61021"],
 " then we get the vector multipoles."
}], "Text",ExpressionUUID->"abfa4f51-5e21-4a02-995c-60f72e5b8339"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"polE", "[", 
    RowBox[{"p_", ",", "scalarF_", ",", "args_"}], "]"}], ":=", 
   RowBox[{"Curl", "[", 
    RowBox[{
     RowBox[{"Curl", "[", 
      RowBox[{
       RowBox[{"p", " ", "scalarF"}], ",", "args"}], "]"}], ",", "args"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"p", " ", "scalarF"}], "+", 
    RowBox[{"Grad", "[", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"p", ",", 
        RowBox[{"Grad", "[", 
         RowBox[{"scalarF", ",", "args"}], "]"}]}], "]"}], ",", "args"}], 
     "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polM", "[", 
   RowBox[{"p_", ",", "scalarF_", ",", "args_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   RowBox[{"Curl", "[", 
    RowBox[{
     RowBox[{"p", " ", "scalarF"}], ",", "args"}], 
    "]"}]}]}]}], \
"Input",ExpressionUUID->"7cf20987-1af6-4c39-9fa8-004037a14427"],

Cell[BoxData[
 RowBox[{
  RowBox[{"toCylindrical", "[", "Vexp_", "]"}], ":=", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "Vexp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{
        "Vexp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
         "Vexp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{
        "Vexp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
      RowBox[{
      "Vexp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "}"}],
     "\[IndentingNewLine]", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"\[Rho]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"dead65fa-b2b9-4a07-b98d-6209d64f8c70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]p", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "\[ImaginaryI]", ",", "0"}], "}"}], "/", 
    SqrtBox["2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]m", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}], "/", 
    SqrtBox["2"]}]}], 
  ";"}]}], "Input",ExpressionUUID->"a50e718c-9f98-4dc3-b2d2-2d4b6421a6de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ur", "[", 
   RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
   "}"}]}]], "Input",ExpressionUUID->"340b96b4-6edb-4109-a82b-5d2d323df3bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"ur", "[", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"ur", "[", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "//", 
  "Simplify"}]], \
"Input",ExpressionUUID->"1b672fa5-d179-4663-8555-e5caf2471c2d"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"Sin", "[", "\[Theta]", "]"}], 
  "2"]], "Output",ExpressionUUID->"2ef4d52d-4a9c-4c16-8ac3-9ee748ad542a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["UnitE", \
"Subsubsection",ExpressionUUID->"3128a8f5-f9e3-4761-81bb-555ad671fe8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitE", "::", "usage"}], "=", 
    "\"\<UnitE[s] gives the unit vectors \!\(\*SubscriptBox[\(e\), \(s\)]\) \
for s=-1,0,1, equal to (1,-i,0)/\!\(\*SqrtBox[\(2\)]\), (0,0,1) and \
(1,i,0)/\!\(\*SqrtBox[\(2\)]\), respectively.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnitE", "[", 
   RowBox[{"s", ":", 
    RowBox[{"(", 
     RowBox[{"1", "|", 
      RowBox[{"-", "1"}]}], ")"}]}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"s", " ", "\[ImaginaryI]"}], ",", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnitE", "[", "0", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"11451e4c-932f-4cad-b793-2d7269bb9aa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PolarizationV variants", \
"Subsubsection",ExpressionUUID->"d9b6c49e-fbb5-4b81-afb7-fe21aa6b5db5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVElectric", "::", "usage"}], "=", 
   "\"\<PolarizationVElectric[v,f[x,y,z],{x,y,z}] gives the electric-type \
polarization operator \!\(\*SubsuperscriptBox[\(V\), \(r\), \((E)\)]\)(v,f)=\
\[Del]\[Times](\[Del]\[Times](v f)) for a vector v and a scalar function f.\n\
PolarizationVElectric[v,f] gives the functional form of \
\!\(\*SubsuperscriptBox[\(V\), \(r\), \((E)\)]\)(v,f). The vector v can be a \
fixed object or an explicit Function object.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVMagnetic", "::", "usage"}], "=", 
   "\"\<PolarizationVMagnetic[v,f[x,y,z],{x,y,z}] gives the magnetic-type \
polarization operator \!\(\*SubsuperscriptBox[\(V\), \(r\), \
\((M)\)]\)(v,f)=-i\[Del]\[Times](v f) for a vector v and a scalar function f.\
\nPolarizationVMagnetic[v,f] gives the functional form of \
\!\(\*SubsuperscriptBox[\(V\), \(r\), \((M)\)]\)(v,f). The vector v can be a \
fixed object or an explicit Function object.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolarizationVHelicity", "::", "usage"}], "=", 
    "\"\<PolarizationVHelicity[\[Sigma],f[x,y,z],{x,y,z}] gives the \
helicity-type polarization operator \!\(\*SubsuperscriptBox[\(V\), \(r\), \((\
\[PlusMinus])\)]\)(f)=\!\(\*SubsuperscriptBox[\(V\), \(r\), \
\((E)\)]\)(\!\(\*SubscriptBox[\(e\), \
\(\[PlusMinus]\)]\),f)\[PlusMinus]\!\(\*SubsuperscriptBox[\(iV\), \(r\), \
\((M)\)]\)(\!\(\*SubscriptBox[\(e\), \(\[PlusMinus]\)]\),f) for a helicity \
\[Sigma]=\[PlusMinus]1 and a scalar function f.\nPolarizationVHelicity[\
\[Sigma],f] gives the functional form of \!\(\*SubsuperscriptBox[\(V\), \
\(r\), \((\[PlusMinus])\)]\)(f).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationVElectric", "[", 
   RowBox[{"vector_", ",", "scalarFunction_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Curl", "[", 
   RowBox[{
    RowBox[{"Curl", "[", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"vector", ",", "scalarFunction"}], "]"}], ",", "variables"}], 
     "]"}], ",", "variables"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationVMagnetic", "[", 
   RowBox[{"vector_", ",", "scalarFunction_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   RowBox[{"Curl", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"vector", ",", "scalarFunction"}], "]"}], ",", "variables"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVHelicity", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", 
        RowBox[{"-", "1"}]}], ")"}]}], ",", "scalarFunction_", ",", 
     "variables_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PolarizationVElectric", "[", 
     RowBox[{
      RowBox[{"UnitE", "[", "s", "]"}], ",", "scalarFunction", ",", 
      "variables"}], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "s", " ", 
     RowBox[{"PolarizationVMagnetic", "[", 
      RowBox[{
       RowBox[{"UnitE", "[", "s", "]"}], ",", "scalarFunction", ",", 
       "variables"}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationVElectric", "[", 
   RowBox[{"vector_", ",", "scalarFunction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{"PolarizationVElectric", "[", 
        RowBox[{"vector", ",", 
         RowBox[{"scalarFunction", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVElectric", "[", 
    RowBox[{"vector_Function", ",", "scalarFunction_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{"PolarizationVElectric", "[", 
         RowBox[{
          RowBox[{"vector", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"scalarFunction", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolarizationVMagnetic", "[", 
   RowBox[{"vector_", ",", "scalarFunction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{"PolarizationVMagnetic", "[", 
        RowBox[{"vector", ",", 
         RowBox[{"scalarFunction", "[", 
          RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVMagnetic", "[", 
    RowBox[{"vector_Function", ",", "scalarFunction_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{"PolarizationVMagnetic", "[", 
         RowBox[{
          RowBox[{"vector", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"scalarFunction", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarizationVHelicity", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"(", 
       RowBox[{"1", "|", 
        RowBox[{"-", "1"}]}], ")"}]}], ",", "scalarFunction_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PolarizationVElectric", "[", 
          RowBox[{
           RowBox[{"UnitE", "[", "s", "]"}], ",", 
           RowBox[{"scalarFunction", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "s", " ", 
          RowBox[{"PolarizationVMagnetic", "[", 
           RowBox[{
            RowBox[{"UnitE", "[", "s", "]"}], ",", 
            RowBox[{"scalarFunction", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"80eb1906-037d-4820-a34f-a0b6806a2832"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", "=", 
     RowBox[{"Unique", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "x"}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"a3b75041-1b9b-4ced-9674-8082683c1ca8"],

Cell[BoxData["x$3080"], \
"Output",ExpressionUUID->"e8f07204-83ba-4d14-ae57-bb6b80f2993d"]
}, Open  ]],

Cell[BoxData["Quit"], \
"Input",ExpressionUUID->"23dab06c-8587-44f3-a169-b37442ef8bc1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"bb4c6c44-495a-494b-832f-7e4ea0115440"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "Private`x", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{"Private`x", ",", "\[IndentingNewLine]", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        SuperscriptBox["Private`x", "n"], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}], "]"}]}],
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"27a63eee-9bec-4584-b64d-e23d40cbe893"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"Private`x", ",", 
   FractionBox["1", 
    RowBox[{"1", "-", "Private`x"}]]}], 
  "]"}]], "Output",ExpressionUUID->"7adea63f-39ad-4f83-9532-96a52eb7202b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   SuperscriptBox["x", "n"], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"c9929be3-9c4d-4ace-b46a-c662c0ed9742"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
  "1", "-", 
   "x"}]]], "Output",ExpressionUUID->"e046008b-0350-46a0-9fcb-e0399f68d791"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"PolarizationVElectric", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"BesselJ", "[", 
    RowBox[{"1", ",", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"2676137f-0d56-46c6-853a-a1fa808dd4dd"],

Cell[BoxData[
 RowBox[{"PolarizationVElectric", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"1", ",", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"26fb0a05-f514-4f07-a0a9-17a48c836f14"],

Cell[BoxData[
 RowBox[{"PolarizationVElectric", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "z", ",", "x"}], "}"}], ",", 
   RowBox[{"BesselJ", "[", 
    RowBox[{"1", ",", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"f3d9a37c-9b4c-47b4-8ee2-6e3a1b78d8d3"],

Cell[BoxData[
 RowBox[{"PolarizationVElectric", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "#3", ",", "#1"}], "}"}], "]"}], ",", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"1", ",", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",ExpressionUUID->"21fe364f-6dd3-4d98-95a1-da210ef33755"],

Cell[BoxData[
 RowBox[{"polM", "[", 
  RowBox[{"\[Epsilon]p", ",", 
   RowBox[{"multipoles\[CapitalLambda]", "[", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"z", "-", 
        RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"4c22c3cd-fff7-4b31-8e04-cfdfcd6a7713"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolarizationVMagnetic", "[", 
  RowBox[{
   RowBox[{"UnitE", "[", "1", "]"}], ",", 
   RowBox[{
    RowBox[{"Multipole\[CapitalLambda]", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2", ",", 
        RowBox[{"#3", "-", 
         RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], "&"}]}], 
  "]"}]], "Input",ExpressionUUID->"3ab3ba09-4431-4b3c-b63f-fc2d123a4a36"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "CoMMfoc`Private`x$", ",", "CoMMfoc`Private`y$", ",", 
     "CoMMfoc`Private`z$"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
        "CoMMfoc`Private`z$"}], ")"}], " ", 
      RowBox[{"AnalyticalBesselJ", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"CoMMfoc`Private`x$", ",", "CoMMfoc`Private`y$", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
           "CoMMfoc`Private`z$"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
        "CoMMfoc`Private`z$"}], ")"}], " ", 
      RowBox[{"AnalyticalBesselJ", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"CoMMfoc`Private`x$", ",", "CoMMfoc`Private`y$", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
           "CoMMfoc`Private`z$"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SqrtBox[
          RowBox[{"2", " ", "\[Pi]"}]], " ", "CoMMfoc`Private`x$", " ", 
         RowBox[{"AnalyticalBesselJ", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"CoMMfoc`Private`x$", ",", "CoMMfoc`Private`y$", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
              "CoMMfoc`Private`z$"}]}], "}"}]}], "]"}]}], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"2", " ", "\[Pi]"}]], " ", "CoMMfoc`Private`y$", " ", 
         RowBox[{"AnalyticalBesselJ", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"CoMMfoc`Private`x$", ",", "CoMMfoc`Private`y$", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", 
              "CoMMfoc`Private`z$"}]}], "}"}]}], "]"}]}]}], ")"}]}]}], 
    "}"}]}], "]"}]], \
"Output",ExpressionUUID->"6a53a8ff-c064-4b23-bb5d-bedb34e11826"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"PolarizationVMagnetic", "[", 
   RowBox[{
    RowBox[{"UnitE", "[", "1", "]"}], ",", 
    RowBox[{"Multipole\[CapitalLambda]", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "\[IndentingNewLine]",
   "]"}]], "Input",ExpressionUUID->"f950fb77-0190-4e6a-84f9-45570f1f2502"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}], ")"}], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{"q", "+", 
      RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]]}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"\[ImaginaryI]", " ", "y"}]}], ")"}], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"ea056bad-66b2-4071-8905-ca352ae2ee10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"PolarizationVHelicity", "[", 
   RowBox[{"1", ",", 
    RowBox[{"Multipole\[CapitalLambda]", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "\[IndentingNewLine]",
   "]"}]], "Input",ExpressionUUID->"94fdfb0d-387f-4989-aead-ba7308e609ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"\[ImaginaryI]", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "q", " ", "z"}], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["q", "2"]}], "-", 
         RowBox[{"2", " ", "q", " ", "z"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            RowBox[{"\[ImaginaryI]", " ", "x", " ", "y"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "+", "y"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"AnalyticalBesselJ", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}],
        "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"65541eba-bec8-4f73-a46f-11e0069f8f31"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"PolarizationVHelicity", "[", 
   RowBox[{"1", ",", 
    RowBox[{"Multipole\[CapitalLambda]", "[", 
     RowBox[{"l", ",", "m", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "\[IndentingNewLine]",
   "]"}]], "Input",ExpressionUUID->"9030b8ad-addf-4bca-b080-318b8aee1616"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"a949e294-2956-4b5a-9cd3-6d34ea2ec027"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fields", \
"Subsection",ExpressionUUID->"3effdee2-50e9-4205-8d03-ef0700f800a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ComplexFocusHelicityE", "[", 
   RowBox[{"l_", ",", "m_", ",", 
    RowBox[{"s", ":", 
     RowBox[{"(", 
      RowBox[{"1", "|", 
       RowBox[{"-", "1"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "q_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xInt", ",", "yInt", ",", "zInt", ",", "qInt"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ComplexFocusHelicityE", "[", 
       RowBox[{"l", ",", "m", ",", "s", ",", 
        RowBox[{"{", 
         RowBox[{"xInt_", ",", "yInt_", ",", "zInt_"}], "}"}], ",", "qInt_"}],
        "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"PolarizationVHelicity", "[", 
        RowBox[{"s", ",", 
         RowBox[{"Multipole\[CapitalLambda]", "[", 
          RowBox[{"l", ",", "m", ",", 
           RowBox[{"{", 
            RowBox[{"xInt", ",", "yInt", ",", 
             RowBox[{"zInt", "-", 
              RowBox[{"\[ImaginaryI]", " ", "qInt"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xInt", ",", "yInt", ",", "zInt"}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"ComplexFocusHelicityE", "[", 
      RowBox[{"l", ",", "m", ",", "s", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComplexFoxusElectricE", "[", 
   RowBox[{"l_", ",", "m_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "q_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xInt", ",", "yInt", ",", "zInt", ",", "qInt"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ComplexFoxusElectricE", "[", 
       RowBox[{"l", ",", "m", ",", 
        RowBox[{"{", 
         RowBox[{"xInt_", ",", "yInt_", ",", "zInt_"}], "}"}], ",", "qInt_"}],
        "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"PolarizationVElectric", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"Multipole\[CapitalLambda]", "[", 
          RowBox[{"l", ",", "m", ",", 
           RowBox[{"{", 
            RowBox[{"xInt", ",", "yInt", ",", 
             RowBox[{"zInt", "-", 
              RowBox[{"\[ImaginaryI]", " ", "qInt"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xInt", ",", "yInt", ",", "zInt"}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"ComplexFoxusElectricE", "[", 
      RowBox[{"l", ",", "m", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComplexFocusMagneticE", "[", 
   RowBox[{"l_", ",", "m_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "q_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xInt", ",", "yInt", ",", "zInt", ",", "qInt"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ComplexFocusMagneticE", "[", 
       RowBox[{"l", ",", "m", ",", 
        RowBox[{"{", 
         RowBox[{"xInt_", ",", "yInt_", ",", "zInt_"}], "}"}], ",", "qInt_"}],
        "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"PolarizationVMagnetic", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"Multipole\[CapitalLambda]", "[", 
          RowBox[{"l", ",", "m", ",", 
           RowBox[{"{", 
            RowBox[{"xInt", ",", "yInt", ",", 
             RowBox[{"zInt", "-", 
              RowBox[{"\[ImaginaryI]", " ", "qInt"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xInt", ",", "yInt", ",", "zInt"}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"ComplexFocusMagneticE", "[", 
      RowBox[{"l", ",", "m", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"8ff8dcce-571d-421e-b883-9b3f923a1d9c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ComplexFocusHelicityE", "[", 
  RowBox[{"0", ",", "0", ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ComplexFoxusElectricE", "[", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ComplexFocusMagneticE", "[", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "q"}], 
  "]"}]}], "Input",ExpressionUUID->"2d50e4f3-57ed-4c88-849c-63884e1f771a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q", "2"], "+", 
         RowBox[{"\[ImaginaryI]", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "q", " ", "z"}], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["q", "2"]}], "-", 
         RowBox[{"2", " ", "q", " ", "z"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            RowBox[{"\[ImaginaryI]", " ", "x", " ", "y"}], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "x"}], "+", "y"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"AnalyticalBesselJ", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}],
        "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q", "+", 
         RowBox[{"\[ImaginaryI]", " ", "z"}]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"00bf5c23-9854-41b7-8fc7-8cf2767eef78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SqrtBox["\[Pi]"], " ", "x", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}], ")"}], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"2", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", 
   RowBox[{"2", " ", 
    SqrtBox["\[Pi]"], " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}], ")"}], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"2", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", 
   RowBox[{"2", " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], " ", 
       RowBox[{"AnalyticalBesselJ", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], 
          "}"}]}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",ExpressionUUID->"98263f72-7c2f-4abb-a6bc-4f45a504e1fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "\[ImaginaryI]", " ", 
    SqrtBox["\[Pi]"], " ", "y", " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
    SqrtBox["\[Pi]"], " ", "x", " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "q"}], "+", "z"}]}], "}"}]}], 
     "]"}]}], ",", "0"}], 
  "}"}]], "Output",ExpressionUUID->"9b18ab11-5eb8-47c0-a4e1-62f137b81391"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolarizationVHelicity", "[", 
  RowBox[{"1", ",", 
   RowBox[{"2", " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"AnalyticalBesselJ", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"xInt", ",", "yInt", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
       "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"xInt", ",", "yInt", ",", "zInt"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"b8d29824-e50c-4ca4-9ba0-9583339b11cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
     " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "xInt", " ", "yInt", " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "-", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SuperscriptBox["yInt", "2"], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "-", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
      "2"], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "-", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
     " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SuperscriptBox["xInt", "2"], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "xInt", " ", "yInt", " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
      "2"], " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "xInt", " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "yInt", " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "xInt", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
     " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "yInt", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}], ")"}], 
     " ", 
     RowBox[{"AnalyticalBesselJ", "[", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"xInt", ",", "yInt", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "qInt"}], "+", "zInt"}]}], 
        "}"}]}], "]"}]}]}]}], 
  "}"}]], "Output",ExpressionUUID->"74fe3019-b074-4032-8b6e-28ec8daec25c"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"330144e4-29f0-40c4-ab12-6d13de885d8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"polE", "[", 
   RowBox[{"\[Epsilon]p", ",", 
    RowBox[{"multipoles\[CapitalLambda]", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "\[IndentingNewLine]",
   "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"polM", "[", 
    RowBox[{"\[Epsilon]p", ",", 
     RowBox[{"multipoles\[CapitalLambda]", "[", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", 
         RowBox[{"z", "-", 
          RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
    "]"}]}]}]], \
"Input",ExpressionUUID->"e8b4f924-b3ad-40d1-9ca5-b8cc208a944c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"2539f4ca-4140-4efc-b1cc-f8162041aa0d"],

Cell[BoxData["Quit"], \
"Input",ExpressionUUID->"803961ea-41e1-4a27-8d2f-d415eed2fcad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_", ",", "q_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"PolarizationVHelicity", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Multipole\[CapitalLambda]", "[", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{"z", "+", 
           RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "+", 
    RowBox[{"PolarizationVHelicity", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"Multipole\[CapitalLambda]", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{"z", "+", 
           RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",ExpressionUUID->"511d967b-e591-414d-a0b3-3b7b481795d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"1", ",", "0", ",", "0", ",", "1"}], 
  "]"}]], "Input",ExpressionUUID->"0894d994-62e8-4f74-9fcd-12ae9183513e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"122", " ", 
       SqrtBox[
        FractionBox["\[Pi]", "15"]]}], "63"]}], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]]}], "5"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
     SqrtBox[
      FractionBox[
       RowBox[{"3", " ", "\[Pi]"}], "5"]]}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", "\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["104", "63"]}], " ", "\[ImaginaryI]", " ", 
     SqrtBox[
      FractionBox["\[Pi]", "15"]]}], "-", 
    RowBox[{
     FractionBox["4", "15"], " ", "\[ImaginaryI]", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]]}]}]}], 
  "}"}]], "Output",ExpressionUUID->"210fd26d-40b9-4fb0-86ec-f7446799d502"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Arrow", "[", 
        RowBox[{"Tube", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "x", ",", "0.01"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "x", ",", "0.01"}], "}"}], "+", 
              RowBox[{"2", 
               FractionBox[
                RowBox[{"Re", "[", "#", "]"}], 
                RowBox[{"Norm", "[", 
                 RowBox[{"Re", "[", "#", "]"}], "]"}]]}]}], "&"}], "[", 
            RowBox[{"f", "[", 
             RowBox[{"x", ",", "x", ",", "0", ",", "1"}], "]"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "2", ",", "0.05"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"1408a1a0-4926-4701-a466-7531341836a7"],

Cell[BoxData[
 Graphics3DBox[{
   Arrow3DBox[TubeBox[{{{0., 0., 0.01}, {2., 9.125840822006127*^-16, 
    0.01}}}]], 
   Arrow3DBox[TubeBox[{{{0.05, 0.05, 0.01}, {1.714591658663975, 
    0.04875990478730904, 1.118662740453643}}}]], 
   Arrow3DBox[TubeBox[{{{0.1, 0.1, 0.01}, {1.3034377488463478`, 
    0.09642513260860817, 1.6074119083613874`}}}]], 
   Arrow3DBox[TubeBox[{{{0.15000000000000002`, 0.15000000000000002`, 0.01}, {
    1.0518266161980947`, 0.14400394256999416`, 1.7951254302182773`}}}]], 
   Arrow3DBox[TubeBox[{{{0.2, 0.2, 0.01}, {0.9136773491335153, 
    0.19162559183982816`, 1.8783132795711017`}}}]], 
   Arrow3DBox[TubeBox[{{{0.25, 0.25, 0.01}, {0.8400743012406198, 
    0.23928142357414636`, 1.9209415038495548`}}}]], 
   Arrow3DBox[TubeBox[{{{0.30000000000000004`, 0.30000000000000004`, 0.01}, {
    0.804322413269503, 0.28695607996641664`, 1.9453265253243914`}}}]], 
   Arrow3DBox[TubeBox[{{{0.35000000000000003`, 0.35000000000000003`, 0.01}, {
    0.7921329920559925, 0.33463866954514315`, 1.960456984109691}}}]], 
   Arrow3DBox[TubeBox[{{{0.4, 0.4, 0.01}, {0.7954494323215592, 
    0.38232175748948444`, 1.9704354685167005`}}}]], 
   Arrow3DBox[TubeBox[{{{0.45, 0.45, 0.01}, {0.8094593552332177, 
    0.4299999732216146, 1.9773304173077242`}}}]], 
   Arrow3DBox[TubeBox[{{{0.5, 0.5, 0.01}, {0.8311363598682219, 
    0.4776691384945842, 1.9822702765588822`}}}]], 
   Arrow3DBox[TubeBox[{{{0.55, 0.55, 0.01}, {0.8584919111500011, 
    0.5253257628809335, 1.9859109096256369`}}}]], 
   Arrow3DBox[TubeBox[{{{0.6000000000000001, 0.6000000000000001, 0.01}, {
    0.8901702008666343, 0.5729667476869782, 1.9886536983005385`}}}]], 
   Arrow3DBox[TubeBox[{{{0.65, 0.65, 0.01}, {0.9252175007794046, 
    0.6205892049077202, 1.9907549905015456`}}}]], 
   Arrow3DBox[TubeBox[{{{0.7000000000000001, 0.7000000000000001, 0.01}, {
    0.96294491732317, 0.6681903404445475, 1.9923844521214542`}}}]], 
   Arrow3DBox[TubeBox[{{{0.75, 0.75, 0.01}, {1.0028435052539855`, 
    0.7157673738868079, 1.993657805459468}}}]], 
   Arrow3DBox[TubeBox[{{{0.8, 0.8, 0.01}, {1.0445299634832614`, 
    0.7633174793314645, 1.994656012924224}}}]], 
   Arrow3DBox[TubeBox[{{{0.8500000000000001, 0.8500000000000001, 0.01}, {
    1.0877108547063896`, 0.8108377382070788, 1.9954369460665375`}}}]], 
   Arrow3DBox[TubeBox[{{{0.9, 0.9, 0.01}, {1.13215841211472, 
    0.8583250986026556, 1.9960427171332178`}}}]], 
   Arrow3DBox[TubeBox[{{{0.9500000000000001, 0.9500000000000001, 0.01}, {
    1.177693804811792, 0.9057763375625312, 1.9965044170428987`}}}]], 
   Arrow3DBox[TubeBox[{{{1., 1., 0.01}, {1.2241753293540336`, 
    0.9531880239052394, 1.9968452533106633`}}}]], 
   Arrow3DBox[TubeBox[{{{1.05, 1.05, 0.01}, {1.271489931209004, 
    1.0005564797280622`, 1.9970826728337574`}}}]], 
   Arrow3DBox[TubeBox[{{{1.1, 1.1, 0.01}, {1.31954702551357, 
    1.047877739067023, 1.997229824027251}}}]], 
   Arrow3DBox[TubeBox[{{{1.1500000000000001`, 1.1500000000000001`, 0.01}, {
    1.368273937243758, 1.0951475023003319`, 1.9972965787260382`}}}]], 
   Arrow3DBox[TubeBox[{{{1.2000000000000002`, 1.2000000000000002`, 0.01}, {
    1.4176125036987361`, 1.1423610848674144`, 1.9972902540133153`}}}]], 
   Arrow3DBox[TubeBox[{{{1.25, 1.25, 0.01}, {1.4675165269208235`, 
    1.1895133587524764`, 1.9972161248205735`}}}]], 
   Arrow3DBox[TubeBox[{{{1.3, 1.3, 0.01}, {1.5179498596961503`, 
    1.2365986849595743`, 1.9970777870807104`}}}]], 
   Arrow3DBox[TubeBox[{{{1.35, 1.35, 0.01}, {1.5688849738401318`, 
    1.2836108348808932`, 1.9968774111609886`}}}]], 
   Arrow3DBox[TubeBox[{{{1.4000000000000001`, 1.4000000000000001`, 0.01}, {
    1.6203019045270695`, 1.3305428980158038`, 1.9966159120085851`}}}]], 
   Arrow3DBox[TubeBox[{{{1.4500000000000002`, 1.4500000000000002`, 0.01}, {
    1.672187496405647, 1.3773871729082747`, 1.9962930533490615`}}}]], 
   Arrow3DBox[TubeBox[{{{1.5, 1.5, 0.01}, {1.7245349006473965`, 
    1.4241350373942134`, 1.9959074967983998`}}}]], 
   Arrow3DBox[TubeBox[{{{1.55, 1.55, 0.01}, {1.7773432899083108`, 
    1.4707767932307294`, 1.995456801857663}}}]], 
   Arrow3DBox[TubeBox[{{{1.6, 1.6, 0.01}, {1.8306177725377528`, 
    1.5173014788354422`, 1.9949373787570528`}}}]], 
   Arrow3DBox[TubeBox[{{{1.6500000000000001`, 1.6500000000000001`, 0.01}, {
    1.88436949979402, 1.563696642082166, 1.9943443924829196`}}}]], 
   Arrow3DBox[TubeBox[{{{1.7000000000000002`, 1.7000000000000002`, 0.01}, {
    1.9386159715802636`, 1.6099480627191665`, 1.9936716126160539`}}}]], 
   Arrow3DBox[TubeBox[{{{1.75, 1.75, 0.01}, {1.9933815584524235`, 
    1.6560394107692098`, 1.9929111993926183`}}}]], 
   Arrow3DBox[TubeBox[{{{1.8, 1.8, 0.01}, {2.0486982715907507`, 
    1.7019518229078854`, 1.9920534111563912`}}}]], 
   Arrow3DBox[TubeBox[{{{1.85, 1.85, 0.01}, {2.1046068295293177`, 
    1.7476633728193107`, 1.9910862114240027`}}}]], 
   Arrow3DBox[TubeBox[{{{1.9000000000000001`, 1.9000000000000001`, 0.01}, {
    2.16115809263432, 1.793148403190345, 1.989994744162426}}}]], 
   Arrow3DBox[TubeBox[{{{1.9500000000000002`, 1.9500000000000002`, 0.01}, {
    2.218414966337035, 1.8383766752702781`, 1.9887606321186433`}}}]], 
   Arrow3DBox[TubeBox[{{{2., 2., 0.01}, {2.276454915978726, 1.88331227519153, 
    1.987361032869369}}}]]},
  Axes->True,
  ImageSize->{832.5147967000905, 715.},
  ViewPoint->{1.3427825334675998`, -1.0361771989114246`, 2.9280150068383204`},
  ViewVertical->{-0.05304999367975245, 0.6104996026289542, 
   0.9648808956241718}]], \
"Output",ExpressionUUID->"183c1367-b730-46e2-b9b5-fd023d36da83"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Multipole\[CapitalLambda]", "[", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", 
     RowBox[{"z", "+", 
      RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"8ebe37c8-1730-4165-80fc-4a04e458a313"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SqrtBox["\[Pi]"], " ", 
  RowBox[{"AnalyticalBesselJ", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "q"}], "+", "z"}]}], "}"}]}], 
   "]"}]}]], "Output",ExpressionUUID->"102b35c1-9ed8-4441-bf33-eb43bbbbf8e9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_", ",", "q_"}], "]"}], "=", 
   RowBox[{"PolarizationVHelicity", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Multipole\[CapitalLambda]", "[", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", 
         RowBox[{"z", "+", 
          RowBox[{"\[ImaginaryI]", " ", "q"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"f3e8d9af-b132-4762-962e-1ab409787581"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "=", "3"}], ",", 
     RowBox[{"\[CapitalDelta]", "=", "0.5"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "0.012", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue"}], "}"}], "\[LeftDoubleBracket]", 
               "j", "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Arrow", "[", 
               RowBox[{"Tube", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "0"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "0"}], "}"}], "+", 
                    RowBox[{"0.2", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Re", ",", "Im"}], "}"}], "\[LeftDoubleBracket]", 
                    "j", "\[RightDoubleBracket]"}], "[", "#", "]"}], 
                    RowBox[{"1", 
                    RowBox[{"(*", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"Re", "[", "#", "]"}], "]"}], "*)"}]}]]}]}], 
                    "&"}], "[", 
                   RowBox[{"g", "[", 
                    RowBox[{"x", ",", "y", ",", "0", ",", "1"}], "]"}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "2"}], "}"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "R"}], ",", "R", ",", "\[CapitalDelta]"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "R"}], ",", "R", ",", "\[CapitalDelta]"}], "}"}]}],
            "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "0"}], "}"}], "+", 
            RowBox[{"0.2", 
             RowBox[{"Re", "[", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]t"}]], 
               RowBox[{"g", "[", 
                RowBox[{"x", ",", "y", ",", "0", ",", "1"}], "]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]t", ",", "0", ",", 
             RowBox[{"2", "\[Pi]"}]}], "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"PlotPoints", "\[Rule]", "10"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"MaxRecursion", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
          "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "R"}], ",", "R", ",", "\[CapitalDelta]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "R"}], ",", "R", ",", "\[CapitalDelta]"}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
     RowBox[{"ImageSize", "\[Rule]", "950"}], "\[IndentingNewLine]", ",", 
     RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"25cebf15-7745-4489-9995-9b7df7986b91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fields", \
"Subsection",ExpressionUUID->"f02766ed-f948-4f8f-a93a-e55fc800d745"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"blochCSkyrmT", "[", 
    RowBox[{"qg_", ",", "qv_", ",", "\[Gamma]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]Tg", "[", "qg", "]"}], 
      RowBox[{"polM", "[", 
       RowBox[{"\[Epsilon]p", ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]Tv", "[", "qv", "]"}], 
      RowBox[{"polM", "[", 
       RowBox[{"\[Epsilon]m", ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"2", ",", "2", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qv"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"e54d3811-0ab3-4906-a477-6fbe6a48616f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"blochCSkyrmQC", "[", 
    RowBox[{"qg_", ",", "qv_", ",", "\[Gamma]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]QCg", "[", "qg", "]"}], 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polE", "[", 
         RowBox[{"\[Epsilon]p", ",", 
          RowBox[{"multipoles\[CapitalLambda]", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"z", "-", 
               RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"polM", "[", 
          RowBox[{"\[Epsilon]p", ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"z", "-", 
                RowBox[{"\[ImaginaryI]", " ", "qg"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]QCv", "[", "qv", "]"}], 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polE", "[", 
         RowBox[{"\[Epsilon]m", ",", 
          RowBox[{"multipoles\[CapitalLambda]", "[", 
           RowBox[{"2", ",", "2", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"z", "-", 
               RowBox[{"\[ImaginaryI]", " ", "qv"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"polM", "[", 
          RowBox[{"\[Epsilon]m", ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"z", "-", 
                RowBox[{"\[ImaginaryI]", " ", "qv"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"a843d115-a861-4e6e-8fe8-b7f6451fe34c"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"af3a2e02-92cc-49bb-a356-dd3d0545e7cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"blochLSkyrm", "[", 
    RowBox[{"qr_", ",", "qa_", ",", "\[Gamma]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]TEM00", "[", "qr", "]"}], " ", 
      RowBox[{"polE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qr"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]TEM00", "[", "qa", "]"}], 
      RowBox[{"polM", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qa"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blochLxL", "[", 
   RowBox[{"qr_", ",", "qa_", ",", "\[Gamma]_", ",", "xm_", ",", "pts_"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"blochLSkyrm", "[", 
     RowBox[{"qr", ",", "qa", ",", "\[Gamma]", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.00001"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "xm", ",", 
      RowBox[{"xm", "/", 
       RowBox[{"(", 
        RowBox[{"pts", "-", "1"}], ")"}]}]}], "}"}]}], 
   "]"}]}]}], "Input",ExpressionUUID->"e09f59fc-3f44-4fcf-8e7b-452b5bb5f182"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"neelCSkyrmT", "[", 
    RowBox[{"\[Gamma]_", ",", "\[Delta]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Delta]", "]"}], 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
         RowBox[{"polM", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[ImaginaryI]", ",", "0"}], "}"}], ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"1", ",", "0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
         RowBox[{"polM", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Delta]", "]"}], 
      RowBox[{"polE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0975939f-a67b-4bcb-b07d-db458e5b53e3"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"80c3b74b-cf0d-4979-b366-075426e9e1a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"neelCSkyrmT", "[", 
    RowBox[{"\[Gamma]_", ",", "\[Delta]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Delta]", "]"}], 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
         RowBox[{"polM", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[ImaginaryI]", ",", "0"}], "}"}], ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"1", ",", "0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
         RowBox[{"polM", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"multipoles\[CapitalLambda]", "[", 
            RowBox[{"3", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ")"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Delta]", "]"}], 
      RowBox[{"polE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"8863d1c3-47de-43d0-94b7-da361b4cc6ff"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"373e6eaa-77c5-498d-8119-7f15275af6d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"neelLSkyrm", "[", 
    RowBox[{"qr1_", ",", "qr2_", ",", "\[Gamma]_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]TEM00", "[", "qr1", "]"}], 
      RowBox[{"polE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qr1"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", "\[Gamma]", "]"}], 
      RowBox[{"\[Alpha]TEM10", "[", "qr2", "]"}], 
      RowBox[{"polE", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"multipoles\[CapitalLambda]", "[", 
         RowBox[{"1", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"\[ImaginaryI]", " ", "qr2"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neelLxL", "[", 
   RowBox[{"qr1_", ",", "qr2_", ",", "\[Gamma]_", ",", "xm_", ",", "pts_"}], 
   "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"neelLSkyrm", "[", 
     RowBox[{"qr1", ",", "qr2", ",", "\[Gamma]", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.00001"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "xm", ",", 
      RowBox[{"xm", "/", 
       RowBox[{"(", 
        RowBox[{"pts", "-", "1"}], ")"}]}]}], "}"}]}], 
   "]"}]}]}], "Input",ExpressionUUID->"b65e5020-4120-4969-826d-aab23ab58c4e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"c5c0c50a-cdeb-44f0-8d23-7030caff8d67"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalization", \
"Subsection",ExpressionUUID->"a13dc932-a3f1-47ce-bb6a-eded3eb06192"],

Cell[CellGroupData[{

Cell["CFnormTEM", \
"Subsubsection",ExpressionUUID->"da7807fa-4d0e-41ac-b4d9-c17267e3d0aa"],

Cell["\<\
Using partial memoization as per https://mathematica.stackexchange.com/q/21782\
\>", "Text",ExpressionUUID->"22636eef-7e67-467f-be47-6c2b85492e90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CFnormTEM", "::", "usage"}], "=", 
    "\"\<CFnormTEM[l,m,q] returns the normalization integral \[Integral]|\!\(\
\*SubscriptBox[\(Y\), \(lm\)]\)(\[Theta],\[Phi])\!\(\*SuperscriptBox[\(|\), \
\(2\)]\)\!\(\*SuperscriptBox[\(e\), \(2  q\\\ cos \((\[Theta])\)\)]\)sin(\
\[Theta]\!\(\*SuperscriptBox[\()\), \(2\)]\)d\[CapitalOmega] for the TEM \
complex-focus fields.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]TEM", "::", "usage"}], "=", 
    "\"\<\[Alpha]TEM[l,m,q] returns the normalization constant \
CFnormTEM[l,m,q\!\(\*SuperscriptBox[\(]\), \(\(-1\)/2\)]\) for the TEM \
complex-focus fields.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]TEM", "[", 
    RowBox[{"l_", ",", "m_", ",", "q_"}], "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"l", ",", "m", ",", "q"}], "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFnormTEM", "[", 
   RowBox[{"l_", ",", "m_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "qInt", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CFnormTEM", "[", 
       RowBox[{"l", ",", "m", ",", "qInt_"}], "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", 
            RowBox[{"-", "m"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"2", "qInt", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], ")"}], "2"], 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CFnormTEM", "[", 
      RowBox[{"l", ",", "m", ",", "q"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFnormTEM", "[", 
   RowBox[{"l_", ",", "m_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CFnormTEM", "[", 
    RowBox[{"l", ",", "m", ",", "0"}], "]"}], "=", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"CFnormTEM", "[", 
      RowBox[{"l", ",", "m", ",", "q"}], "]"}], ",", 
     RowBox[{"q", "\[Rule]", "0"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"7b97419a-30b2-4c66-a884-1d467c588673"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CFnormTEM", "[", 
  RowBox[{"0", ",", "0", ",", "q"}], 
  "]"}]], "Input",ExpressionUUID->"012904f9-83ab-4456-aea0-8fcac44ca46d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "q", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"2", " ", "q"}], "]"}]}], "-", 
   RowBox[{"Sinh", "[", 
    RowBox[{"2", " ", "q"}], "]"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["q", 
    "3"]}]]], "Output",ExpressionUUID->"f4b86aa8-9dd6-4750-9275-e2b79970b203"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Special cases of CFnormTEM", \
"Subsubsection",ExpressionUUID->"45fb5853-4b17-4d95-baef-784411b22ae7"],

Cell[TextData[{
 "The partially-memoized evaluation in the definition of CFnormTEM ensures \
that the expensive symbolic integration is only ever performed once for each ",
 Cell[BoxData[
  FormBox[
   RowBox[{"l", ",", "m"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "278cbd5d-10fd-4982-b10f-d4ad7b889923"],
 " pair. However, this still means that the code will take a few seconds to \
run the first time that each pair is evaluated.\n\nThis can be mitigated by \
pre-computing the first few cases and including them as explicit definitions \
in the package .m file. To do that, the code below computes the first few \
cases and then writes them into the initialization cell below."
}], "Text",ExpressionUUID->"b0593bc0-0a6c-4cb1-88e4-e2d225c74f9c"],

Cell[BoxData[
 RowBox[{"NotebookWrite", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Cells", "[", 
     RowBox[{"CellTags", "\[Rule]", "\"\<CFNormTEM-SpecialCases\>\""}], "]"}],
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Cell", "[", 
    RowBox[{
     RowBox[{"BoxData", "[", 
      RowBox[{"RowBox", "[", 
       RowBox[{"Most", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<(*This cell is auto-generated. Any changes will be \
over-ridden if the cell above is evaluated.*)\>\"", ",", 
             "\"\<\\\\[IndentingNewLine]\>\""}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Begin[\\\"`Private`\\\"];\>\"", ",", 
             "\"\<\\\\[IndentingNewLine]\>\""}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<CFnormTEM[\>\"", "<>", 
                  RowBox[{"ToString", "[", "l", "]"}], "<>", "\"\<,\>\"", "<>", 
                  RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<,q_]\>\""}],
                  ",", "\[IndentingNewLine]", "\"\<:=\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"CFnormTEM", "[", 
                    RowBox[{"l", ",", "m", ",", "q"}], "]"}], ",", 
                   "InputForm"}], "]"}], ",", "\[IndentingNewLine]", 
                 "\"\<\\\\[IndentingNewLine]\>\""}], "\[IndentingNewLine]", 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<End[];\>\"", ",", "\"\<\\\\[IndentingNewLine]\>\""}],
             "}"}]}], "\[IndentingNewLine]", "]"}], "]"}], "]"}], "]"}], 
      "]"}], ",", "\"\<Input\>\"", ",", 
     RowBox[{"InitializationCell", "\[Rule]", "True"}], ",", 
     RowBox[{"CellTags", "\[Rule]", "\"\<CFNormTEM-SpecialCases\>\""}]}], 
    "\[IndentingNewLine]", "]"}], ",", "None", ",", 
   RowBox[{"AutoScroll", "\[Rule]", "False"}]}], 
  "]"}]], "Input",ExpressionUUID->"ae662f3b-c59c-4dce-8027-f7bd8597e2f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "cell", " ", "is", " ", "auto"}], "-", 
    RowBox[{
     RowBox[{"generated", ".", " ", "Any"}], " ", "changes", " ", "will", " ",
      "be", " ", "over"}], "-", 
    RowBox[{
    "ridden", " ", "if", " ", "the", " ", "cell", " ", "above", " ", "is", 
     " ", 
     RowBox[{"evaluated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"0", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "*", "q", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
       RowBox[{"Sinh", "[", 
        RowBox[{"2", "*", "q"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"4", "*", 
       RowBox[{"q", "^", "3"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"18", "*", "q", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"3", " ", "+", " ", 
          RowBox[{"4", "*", 
           RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"1", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", "*", "q", "*", 
        RowBox[{"(", 
         RowBox[{"3", " ", "+", " ", 
          RowBox[{"q", "^", "2"}]}], ")"}], "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"3", " ", "+", " ", 
          RowBox[{"5", "*", 
           RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"4", "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"1", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"18", "*", "q", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"3", " ", "+", " ", 
          RowBox[{"4", "*", 
           RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "2"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"45", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"15", " ", "+", " ", 
            RowBox[{"4", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"18", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", 
            RowBox[{"2", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"45", " ", "+", " ", 
            RowBox[{"78", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"16", "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"2", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"405", " ", "+", " ", 
            RowBox[{"180", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"405", " ", "+", " ", 
            RowBox[{"720", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"104", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"32", "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"2", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"18", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", 
            RowBox[{"2", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"45", " ", "+", " ", 
            RowBox[{"78", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"16", "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"2", ",", "2", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"45", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"15", " ", "+", " ", 
            RowBox[{"4", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"5", " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "3"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"105", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"21", " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"105", " ", "+", " ", 
            RowBox[{"180", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"16", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "2"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"315", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"95", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"4", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"375", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"56", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"21", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"2625", " ", "+", " ", 
            RowBox[{"1300", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"96", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"7875", " ", "+", " ", 
            RowBox[{"64", "*", 
             RowBox[{"q", "^", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{"225", " ", "+", " ", 
               RowBox[{"42", "*", 
                RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
               RowBox[{"q", "^", "4"}]}], ")"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"7", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"15750", " ", "+", " ", 
            RowBox[{"8025", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"684", "*", 
             RowBox[{"q", "^", "4"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "6"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"15750", " ", "+", " ", 
            RowBox[{"29025", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"5784", "*", 
             RowBox[{"q", "^", "4"}]}], " ", "+", " ", 
            RowBox[{"200", "*", 
             RowBox[{"q", "^", "6"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"32", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"21", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"2625", " ", "+", " ", 
            RowBox[{"1300", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"96", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"7875", " ", "+", " ", 
            RowBox[{"64", "*", 
             RowBox[{"q", "^", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{"225", " ", "+", " ", 
               RowBox[{"42", "*", 
                RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
               RowBox[{"q", "^", "4"}]}], ")"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", "2", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"315", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"95", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"4", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"375", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"56", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormTEM", "[", 
     RowBox[{"3", ",", "3", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"105", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"21", " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}], "*", 
          RowBox[{"Cosh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"105", " ", "+", " ", 
            RowBox[{"180", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"16", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}], "*", 
          RowBox[{"Sinh", "[", 
           RowBox[{"2", "*", "q"}], "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellTags->
  "CFNormTEM-SpecialCases",ExpressionUUID->"2200bde6-c85d-4894-ba79-\
10a108545b34"],

Cell["\<\
To kick-start the process, run SetOptions[EvaluationCell[],CellTags\[Rule]\
\[CloseCurlyDoubleQuote]sample-cell-tag\[CloseCurlyDoubleQuote]] on the \
chosen cell with an appropriate cell tag.\
\>", "Text",ExpressionUUID->"70a41a6b-10e9-46cf-9824-a3fdc383cce1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CFnormQuasiCircular", \
"Subsubsection",ExpressionUUID->"fdcd2fac-4a6d-4b8b-9d46-42d9193c461c"],

Cell["Using partial memoization as with CFnormTEM above.", \
"Text",ExpressionUUID->"7974c57a-27ae-4ce0-a1b7-921773f59f13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "::", "usage"}], "=", 
    "\"\<CFnormQuasiCircular[l,m,q] returns the normalization integral \
\[Integral]|\!\(\*SubscriptBox[\(Y\), \
\(lm\)]\)(\[Theta],\[Phi])\!\(\*SuperscriptBox[\(|\), \
\(2\)]\)\!\(\*SuperscriptBox[\(e\), \(2  q\\\ cos \((\[Theta])\)\)]\)(1+cos(\
\[Theta])\!\(\*SuperscriptBox[\()\), \(2\)]\)d\[CapitalOmega] for the \
quasi-circular complex-focus fields.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]QC", "::", "usage"}], "=", 
    "\"\<\[Alpha]QC[l,m,q] returns the normalization constant \
CFnormQuasiCircular[l,m,q\!\(\*SuperscriptBox[\(]\), \(\(-1\)/2\)]\) for the \
quasi-circular complex-focus fields.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]QC", "[", 
    RowBox[{"l_", ",", "m_", ",", "q_"}], "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"l", ",", "m", ",", "q"}], "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFnormQuasiCircular", "[", 
   RowBox[{"l_", ",", "m_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "qInt", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CFnormQuasiCircular", "[", 
       RowBox[{"l", ",", "m", ",", "qInt_"}], "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"l", ",", 
            RowBox[{"-", "m"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"2", 
            RowBox[{"qIntCos", "[", "\[Theta]", "]"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}], "2"], 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CFnormQuasiCircular", "[", 
      RowBox[{"l", ",", "m", ",", "q"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFnormQuasiCircular", "[", 
   RowBox[{"l_", ",", "m_", ",", "0"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"CFnormQuasiCircular", "[", 
    RowBox[{"l", ",", "m", ",", "0"}], "]"}], "=", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"CFnormQuasiCircular", "[", 
      RowBox[{"l", ",", "m", ",", "q"}], "]"}], ",", 
     RowBox[{"q", "\[Rule]", "0"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"b67db601-638a-4878-a6ff-13759b1c50ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CFnormQuasiCircular", "[", 
  RowBox[{"0", ",", "0", ",", "q"}], 
  "]"}]], "Input",ExpressionUUID->"4d6a6168-ccdc-4735-9e6e-c39f037d0648"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "q"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "q"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", "q"}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["q", "2"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"8", " ", 
   SuperscriptBox["q", 
    "3"]}]]], "Output",ExpressionUUID->"5a12d6f5-d91b-4a58-ab45-272b1f1143d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Special cases of CFnormQuasiCircular", \
"Subsubsection",ExpressionUUID->"4a599663-c109-4233-8ffc-e9c45ca6faad"],

Cell["\<\
Identical to the CFnormTEM special-case handling above, but for \
CFnormQuasiCircular.\
\>", "Text",ExpressionUUID->"665f533d-960c-42ea-b115-954637f46da7"],

Cell[BoxData[
 RowBox[{"NotebookWrite", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Cells", "[", 
     RowBox[{
     "CellTags", "\[Rule]", "\"\<CFnormQuasiCircular-SpecialCases\>\""}], 
     "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Cell", "[", 
    RowBox[{
     RowBox[{"BoxData", "[", 
      RowBox[{"RowBox", "[", 
       RowBox[{"Most", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<(*This cell is auto-generated. Any changes will be \
over-ridden if the cell above is evaluated.*)\>\"", ",", 
             "\"\<\\\\[IndentingNewLine]\>\""}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Begin[\\\"`Private`\\\"];\>\"", ",", 
             "\"\<\\\\[IndentingNewLine]\>\""}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<CFnormQuasiCircular[\>\"", "<>", 
                  RowBox[{"ToString", "[", "l", "]"}], "<>", "\"\<,\>\"", "<>", 
                  RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<,q_]\>\""}],
                  ",", "\[IndentingNewLine]", "\"\<:=\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"CFnormQuasiCircular", "[", 
                    RowBox[{"l", ",", "m", ",", "q"}], "]"}], ",", 
                   "InputForm"}], "]"}], ",", "\[IndentingNewLine]", 
                 "\"\<\\\\[IndentingNewLine]\>\""}], "\[IndentingNewLine]", 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<End[];\>\"", ",", "\"\<\\\\[IndentingNewLine]\>\""}],
             "}"}]}], "\[IndentingNewLine]", "]"}], "]"}], "]"}], "]"}], 
      "]"}], ",", "\"\<Input\>\"", ",", 
     RowBox[{"InitializationCell", "\[Rule]", "True"}], ",", 
     RowBox[{
     "CellTags", "\[Rule]", "\"\<CFnormQuasiCircular-SpecialCases\>\""}]}], 
    "\[IndentingNewLine]", "]"}], ",", "None", ",", 
   RowBox[{"AutoScroll", "\[Rule]", "False"}]}], 
  "]"}]], "Input",ExpressionUUID->"5d4b04ae-8d3a-4d0c-92df-28286bb50c9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "cell", " ", "is", " ", "auto"}], "-", 
    RowBox[{
     RowBox[{"generated", ".", " ", "Any"}], " ", "changes", " ", "will", " ",
      "be", " ", "over"}], "-", 
    RowBox[{
    "ridden", " ", "if", " ", "the", " ", "cell", " ", "above", " ", "is", 
     " ", 
     RowBox[{"evaluated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"0", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"4", "*", "q"}], " ", "+", " ", 
          RowBox[{"8", "*", 
           RowBox[{"q", "^", "2"}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "3"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "q"}], ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], " ", "+", " ", 
            RowBox[{"9", "*", "q"}], " ", "-", " ", 
            RowBox[{"12", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "3"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"16", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"1", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], " ", "-", " ", 
         RowBox[{"3", "*", "q"}], " ", "-", " ", 
         RowBox[{"q", "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"3", " ", "-", " ", 
            RowBox[{"9", "*", "q"}], " ", "+", " ", 
            RowBox[{"13", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "-", " ", 
            RowBox[{"12", "*", 
             RowBox[{"q", "^", "3"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"1", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{"1", " ", "+", " ", "q"}], ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], " ", "+", " ", 
            RowBox[{"9", "*", "q"}], " ", "-", " ", 
            RowBox[{"12", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "3"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"16", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "5"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "2"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"15", " ", "+", " ", 
            RowBox[{"20", "*", "q"}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"45", " ", "-", " ", 
            RowBox[{"120", "*", "q"}], " ", "+", " ", 
            RowBox[{"144", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "-", " ", 
            RowBox[{"96", "*", 
             RowBox[{"q", "^", "3"}]}], " ", "+", " ", 
            RowBox[{"32", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"128", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "15"}], "*", 
       RowBox[{"(", 
        RowBox[{"45", " ", "+", " ", 
         RowBox[{"60", "*", "q"}], " ", "+", " ", 
         RowBox[{"30", "*", 
          RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
         RowBox[{"6", "*", 
          RowBox[{"q", "^", "3"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "45"}], " ", "+", " ", 
            RowBox[{"120", "*", "q"}], " ", "-", " ", 
            RowBox[{"150", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"114", "*", 
             RowBox[{"q", "^", "3"}]}], " ", "-", " ", 
            RowBox[{"56", "*", 
             RowBox[{"q", "^", "4"}]}], " ", "+", " ", 
            RowBox[{"16", "*", 
             RowBox[{"q", "^", "5"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"32", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"2", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "405"}], " ", "-", " ", 
         RowBox[{"4", "*", "q", "*", 
          RowBox[{"(", 
           RowBox[{"135", " ", "+", " ", 
            RowBox[{"2", "*", "q", "*", 
             RowBox[{"(", 
              RowBox[{"36", " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"9", " ", "+", " ", "q"}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"405", " ", "+", " ", 
            RowBox[{"8", "*", "q", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "135"}], " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"171", " ", "+", " ", 
                  RowBox[{"q", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "135"}], " ", "+", " ", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{"73", " ", "+", " ", 
                    RowBox[{"4", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "7"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"2", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "15"}], "*", 
       RowBox[{"(", 
        RowBox[{"45", " ", "+", " ", 
         RowBox[{"60", "*", "q"}], " ", "+", " ", 
         RowBox[{"30", "*", 
          RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
         RowBox[{"6", "*", 
          RowBox[{"q", "^", "3"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "45"}], " ", "+", " ", 
            RowBox[{"120", "*", "q"}], " ", "-", " ", 
            RowBox[{"150", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "+", " ", 
            RowBox[{"114", "*", 
             RowBox[{"q", "^", "3"}]}], " ", "-", " ", 
            RowBox[{"56", "*", 
             RowBox[{"q", "^", "4"}]}], " ", "+", " ", 
            RowBox[{"16", "*", 
             RowBox[{"q", "^", "5"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"32", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"2", ",", "2", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"15", " ", "+", " ", 
            RowBox[{"20", "*", "q"}], " ", "+", " ", 
            RowBox[{"8", "*", 
             RowBox[{"q", "^", "2"}]}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"45", " ", "-", " ", 
            RowBox[{"120", "*", "q"}], " ", "+", " ", 
            RowBox[{"144", "*", 
             RowBox[{"q", "^", "2"}]}], " ", "-", " ", 
            RowBox[{"96", "*", 
             RowBox[{"q", "^", "3"}]}], " ", "+", " ", 
            RowBox[{"32", "*", 
             RowBox[{"q", "^", "4"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"128", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "7"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "3"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "525"}], "*", 
        RowBox[{"(", 
         RowBox[{"42", " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"63", " ", "+", " ", 
             RowBox[{"4", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{"9", " ", "+", " ", 
                RowBox[{"2", "*", "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], " ",
        "-", " ", 
       RowBox[{"105", "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "210"}], " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"525", " ", "+", " ", 
             RowBox[{"8", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "75"}], " ", "+", " ", 
                RowBox[{"2", "*", "q", "*", 
                 RowBox[{"(", 
                  RowBox[{"25", " ", "+", " ", 
                   RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "5"}], " ", "+", " ", "q"}], ")"}], "*", 
                    "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"256", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "2"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"105", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"q", "*", 
             RowBox[{"(", 
              RowBox[{"315", " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"195", " ", "+", " ", 
                  RowBox[{"60", "*", "q"}], " ", "+", " ", 
                  RowBox[{"8", "*", 
                   RowBox[{"q", "^", "2"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
          " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"630", " ", "+", " ", 
            RowBox[{"q", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1575"}], " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"1845", " ", "+", " ", 
                  RowBox[{"8", "*", "q", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "165"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"39", " ", "+", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "+", " ", "q"}], ")"}], "*", 
                    "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"128", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", 
      RowBox[{"-", "1"}], ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "63"}], "*", 
        RowBox[{"(", 
         RowBox[{"5250", " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"7875", " ", "+", " ", 
             RowBox[{"4", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{"1275", " ", "+", " ", 
                RowBox[{"2", "*", "q", "*", 
                 RowBox[{"(", 
                  RowBox[{"225", " ", "+", " ", 
                   RowBox[{"4", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"11", " ", "+", " ", "q"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], " ", "-", " ", 
       RowBox[{"21", "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "15750"}], " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"39375", " ", "+", " ", 
             RowBox[{"16", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2925"}], " ", "+", " ", 
                RowBox[{"q", "*", 
                 RowBox[{"(", 
                  RowBox[{"2175", " ", "+", " ", 
                   RowBox[{"4", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "279"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"51", " ", "+", " ", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "13"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"256", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", "0", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "55125"}], "*", 
        RowBox[{"(", 
         RowBox[{"2", " ", "+", " ", 
          RowBox[{"3", "*", "q"}]}], ")"}]}], " ", "-", " ", 
       RowBox[{"7", "*", 
        RowBox[{"q", "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{"15525", " ", "+", " ", 
          RowBox[{"4", "*", "q", "*", 
           RowBox[{"(", 
            RowBox[{"1425", " ", "+", " ", 
             RowBox[{"2", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{"153", " ", "+", " ", 
                RowBox[{"q", "*", 
                 RowBox[{"(", 
                  RowBox[{"18", " ", "+", " ", "q"}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], " ", "+", " ", 
       RowBox[{"7", "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{"15750", " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "39375"}], " ", "+", " ", 
             RowBox[{"q", "*", 
              RowBox[{"(", 
               RowBox[{"47025", " ", "+", " ", 
                RowBox[{"8", "*", "q", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "4425"}], " ", "+", " ", 
                   RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{"2328", " ", "+", " ", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "894"}], " ", "+", " ", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{"253", " ", "-", " ", 
                    RowBox[{"52", "*", "q"}], " ", "+", " ", 
                    RowBox[{"8", "*", 
                    RowBox[{"q", "^", "2"}]}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"64", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", "1", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "63"}], "*", 
        RowBox[{"(", 
         RowBox[{"5250", " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"7875", " ", "+", " ", 
             RowBox[{"4", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{"1275", " ", "+", " ", 
                RowBox[{"2", "*", "q", "*", 
                 RowBox[{"(", 
                  RowBox[{"225", " ", "+", " ", 
                   RowBox[{"4", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"11", " ", "+", " ", "q"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], " ", "-", " ", 
       RowBox[{"21", "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "15750"}], " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"39375", " ", "+", " ", 
             RowBox[{"16", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2925"}], " ", "+", " ", 
                RowBox[{"q", "*", 
                 RowBox[{"(", 
                  RowBox[{"2175", " ", "+", " ", 
                   RowBox[{"4", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "279"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"51", " ", "+", " ", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "13"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"256", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", "2", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"105", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "*", 
          RowBox[{"(", 
           RowBox[{"210", " ", "+", " ", 
            RowBox[{"q", "*", 
             RowBox[{"(", 
              RowBox[{"315", " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"195", " ", "+", " ", 
                  RowBox[{"60", "*", "q"}], " ", "+", " ", 
                  RowBox[{"8", "*", 
                   RowBox[{"q", "^", "2"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
          " ", "+", " ", 
         RowBox[{
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"4", "*", "q"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"630", " ", "+", " ", 
            RowBox[{"q", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1575"}], " ", "+", " ", 
               RowBox[{"q", "*", 
                RowBox[{"(", 
                 RowBox[{"1845", " ", "+", " ", 
                  RowBox[{"8", "*", "q", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "165"}], " ", "+", " ", 
                    RowBox[{"2", "*", "q", "*", 
                    RowBox[{"(", 
                    RowBox[{"39", " ", "+", " ", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "+", " ", "q"}], ")"}], "*", 
                    "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"128", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CFnormQuasiCircular", "[", 
     RowBox[{"3", ",", "3", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "525"}], "*", 
        RowBox[{"(", 
         RowBox[{"42", " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"63", " ", "+", " ", 
             RowBox[{"4", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{"9", " ", "+", " ", 
                RowBox[{"2", "*", "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], " ",
        "-", " ", 
       RowBox[{"105", "*", 
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{"4", "*", "q"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "210"}], " ", "+", " ", 
          RowBox[{"q", "*", 
           RowBox[{"(", 
            RowBox[{"525", " ", "+", " ", 
             RowBox[{"8", "*", "q", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "75"}], " ", "+", " ", 
                RowBox[{"2", "*", "q", "*", 
                 RowBox[{"(", 
                  RowBox[{"25", " ", "+", " ", 
                   RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "5"}], " ", "+", " ", "q"}], ")"}], "*", 
                    "q"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"256", "*", 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "q"}], ")"}]}], "*", 
       RowBox[{"q", "^", "9"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellTags->
  "CFnormQuasiCircular-SpecialCases",ExpressionUUID->"a58f2859-3cd6-4dcd-887c-\
05802dbd8793"]
}, Open  ]],

Cell[CellGroupData[{

Cell["More stuff", \
"Subsubsection",ExpressionUUID->"a3b2da56-d89b-45fe-9c72-57c2cf910671"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"d53f3a06-11de-4231-a7ff-9ef38b1c9584"],

Cell[BoxData[
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "q", " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"2", " ", "q"}], "]"}]}], "+", 
     RowBox[{"Sinh", "[", 
      RowBox[{"2", " ", "q"}], "]"}]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["q", "3"]}]], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"fa5d37fb-8cb4-4642-b33a-3cdc0c18da40"],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"14d93b7f-cfc8-4d21-b00d-632d4fcf0845"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]Tg", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]Tv", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"2", ",", "2", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], ";", 
  RowBox[{
   RowBox[{"\[Alpha]QCg", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}], "2"], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]QCv", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"2", ",", "2", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}], "2"], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]}], "Input",ExpressionUUID->"ff98e796-330c-4a87-b800-a50649f6c5e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]TEM00", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], ")"}], "2"], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",ExpressionUUID->"4c9ab31b-50f6-4f62-a814-2498960e359f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]TEM10", "[", "q_", "]"}], "=", 
   RowBox[{"1", "/", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"1", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"1", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"2", "q", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], ")"}], "2"], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",ExpressionUUID->"50370743-96db-42b6-8b0e-daf6a6993188"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"2", "q", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "2"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"8a17fc5e-2a71-4bf9-a7f2-6f399f202557"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "q", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"2", " ", "q"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["q", "2"]}]}], ")"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"2", " ", "q"}], "]"}]}]}], 
  RowBox[{"8", " ", 
   SuperscriptBox["q", 
    "3"]}]]], "Output",ExpressionUUID->"caa1f627-4633-4f10-bbcd-af27bd849faf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"2", ",", "2", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}], ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"2", "q", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "2"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"cf555e35-6c1d-4633-82c3-f92bef10653e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.176826`", ",", 
   FractionBox[
    RowBox[{"15", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"15", "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", "q"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"45", "+", 
          RowBox[{"84", " ", 
           SuperscriptBox["q", "2"]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox["q", "4"]}]}], ")"}], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"2", " ", "q"}], "]"}]}]}], ")"}]}], 
    RowBox[{"128", " ", 
     SuperscriptBox["q", "7"]}]]}], 
  "}"}]], "Output",ExpressionUUID->"7502d012-4074-42b5-8767-d847730e531d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"0", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"2", "q", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ")"}], "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"9a972ea0-2aeb-4512-b073-c252d29d364f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.287361`", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "q", " ", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "q"}], "]"}]}], "+", 
      RowBox[{"Sinh", "[", 
       RowBox[{"2", " ", "q"}], "]"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["q", "3"]}]]}]}], 
  "}"}]], "Output",ExpressionUUID->"32fcea01-a0e0-4eda-a7fc-8f68b37eb815"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"1", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"1", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"2", "q", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ")"}], "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"284adbcf-bff8-47f2-b0a8-ced7f4ef045e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9698931`", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"6", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        SuperscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"2", " ", "q"}], "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"Sinh", "[", 
       RowBox[{"2", " ", "q"}], "]"}]}]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["q", "5"]}]]}], 
  "}"}]], "Output",ExpressionUUID->"c65b2922-7c77-41f1-8caa-d63747dd9587"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package closure", \
"Section",ExpressionUUID->"9ef34194-5bc5-402e-b25a-b6b648543098"],

Cell[CellGroupData[{

Cell["End of package", \
"Subsubsection",ExpressionUUID->"08b5aa74-0de0-4690-976b-1c4972ab6314"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7bfde5e2-e60e-49b0-9216-395b306e3c3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add to distributed contexts.", \
"Subsubsection",ExpressionUUID->"627f2346-484c-48d4-9453-1b9800679ff6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", "\"\<CoMMfoc`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"0b59eb5f-39e5-4fe3-a624-8b4b88bac2fa"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
NotebookEventActions->{{"MenuCommand", "Save"} :> (NotebookWrite[
     Part[
      Cells[CellTags -> "version-timestamp"], 1], 
     Cell[
      BoxData[
       RowBox[{
         StringJoin["Begin[\"`Private`\"];\n$CoMMfocTimestamp=\"", 
          DateString[], "\";\nEnd[];"]}]], "Input", InitializationCell -> 
      True, CellTags -> "version-timestamp"], None, AutoScroll -> False]; 
   NotebookSave[]), PassEventsDown -> True},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{None, None, 
   Cell[
    TextData[{
     "RB", "-", "SFA", ":", " ", "Rotating", " ", "Bicircular", " ", "HHG", 
      " ", "in", " ", "the", " ", "Strong", " ", "Field", " ", 
      "Approximation", "|", "   ", 
      StyleBox[
       CounterBox["Page"], "PageNumber"]}], "Header", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}, {None, None, 
   Cell[
    TextData[{
     "RB", "-", "SFA", ":", " ", "Rotating", " ", "Bicircular", " ", "HHG", 
      " ", "in", " ", "the", " ", "Strong", " ", "Field", " ", 
      "Approximation", "|", "   ", 
      StyleBox[
       CounterBox["Page"], "PageNumber"]}], "Header", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}},
PageFooters->{{None, None, None}, {None, None, None}},
PageHeaderLines->{False, False},
PageFooterLines->{False, False},
PrintingOptions->{"FacingPages"->True,
"FirstPageFace"->Right,
"FirstPageFooter"->True,
"FirstPageHeader"->False,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.75, 842.25},
"PostScriptOutputFile"->"~/Desktop/print.pdf",
"PrintingMargins"->{{19.84251968503, 19.84251968503}, {72., 72.}}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{
 "subpackage", "Pisanty", "subpackages"}},
Background->None,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Code"], FontWeight -> "Plain", FontSlant -> "Plain", 
    FontTracking -> "Plain", 
    FontVariations -> {
     "Outline" -> False, "Shadow" -> False, "StrikeThrough" -> False, 
      "Underline" -> False}]}, Visible -> False, FrontEndVersion -> 
  "11.2 for Microsoft Windows (64-bit) (September 10, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

